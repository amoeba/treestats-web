module ExperienceHelper
  EXPERIENCE_BY_LEVEL = {
    1 => 0,
    2 => 1000,
    3 => 2777,
    4 => 5697,
    5 => 10248,
    6 => 17031,
    7 => 26784,
    8 => 40391,
    9 => 58895,
    10 => 83511,
    11 => 115645,
    12 => 156898,
    13 => 209088,
    14 => 274259,
    15 => 354692,
    16 => 452925,
    17 => 571762,
    18 => 714286,
    19 => 883872,
    20 => 1084206,
    21 => 1319289,
    22 => 1593459,
    23 => 1911400,
    24 => 2278153,
    25 => 2699136,
    26 => 3180153,
    27 => 3727407,
    28 => 4347513,
    29 => 5047517,
    30 => 5834900,
    31 => 6717600,
    32 => 7704021,
    33 => 8803044,
    34 => 10024047,
    35 => 11376914,
    36 => 12872048,
    37 => 14520384,
    38 => 16333408,
    39 => 18323161,
    40 => 20502261,
    41 => 22883912,
    42 => 25481915,
    43 => 28310688,
    44 => 31385275,
    45 => 34721359,
    46 => 38335275,
    47 => 42244029,
    48 => 46465302,
    49 => 51017472,
    50 => 55919623,
    51 => 61191556,
    52 => 66853809,
    53 => 72927666,
    54 => 79435170,
    55 => 86399136,
    56 => 93843170,
    57 => 101791673,
    58 => 110269863,
    59 => 119303784,
    60 => 128920317,
    61 => 139147200,
    62 => 150013037,
    63 => 161547311,
    64 => 173780397,
    65 => 186743581,
    66 => 200469064,
    67 => 214989984,
    68 => 230340425,
    69 => 246555428,
    70 => 263671011,
    71 => 281724178,
    72 => 300752932,
    73 => 320796288,
    74 => 341894292,
    75 => 364088025,
    76 => 387419625,
    77 => 411932296,
    78 => 437670319,
    79 => 464679072,
    80 => 493005039,
    81 => 522695823,
    82 => 553800159,
    83 => 586367933,
    84 => 620450186,
    85 => 656099136,
    86 => 693368187,
    87 => 732311940,
    88 => 772986213,
    89 => 815448050,
    90 => 859755734,
    91 => 905968800,
    92 => 954148054,
    93 => 1004355577,
    94 => 1056654747,
    95 => 1111110248,
    96 => 1167788081,
    97 => 1226755584,
    98 => 1288081441,
    99 => 1351835695,
    100 => 1418089761,
    101 => 1486916445,
    102 => 1558389948,
    103 => 1632585888,
    104 => 1709581309,
    105 => 1789454692,
    106 => 1872285975,
    107 => 1958156562,
    108 => 2047149336,
    109 => 2139348672,
    110 => 2234840456,
    111 => 2333712089,
    112 => 2436052509,
    113 => 2541952200,
    114 => 2651503203,
    115 => 2764799136,
    116 => 2881935203,
    117 => 3003008207,
    118 => 3128116563,
    119 => 3257360317,
    120 => 3390841150,
    121 => 3528662400,
    122 => 3670929071,
    123 => 3817747844,
    124 => 3969227097,
    125 => 4125476914,
    126 => 4286609098,
    127 => 4452737184,
    128 => 4623976457,
    129 => 4800443961,
    130 => 4982258511,
    131 => 5169540711,
    132 => 5362412965,
    133 => 5560999488,
    134 => 5765426325,
    135 => 5975821358,
    136 => 6192314325,
    137 => 6415036828,
    138 => 6644122352,
    139 => 6879706272,
    140 => 7121925872,
    141 => 7370920356,
    142 => 7626830859,
    143 => 7889800466,
    144 => 8159974219,
    145 => 8437499136,
    146 => 8722524219,
    147 => 9015200473,
    148 => 9315680913,
    149 => 9624120583,
    150 => 9940676567,
    151 => 10265508000,
    152 => 10598776087,
    153 => 10940644110,
    154 => 11291277447,
    155 => 11650843580,
    156 => 12019512114,
    157 => 12397454784,
    158 => 12784845474,
    159 => 13181860228,
    160 => 13588677261,
    161 => 14005476978,
    162 => 14432441981,
    163 => 14869757088,
    164 => 15317609341,
    165 => 15776188025,
    166 => 16245684675,
    167 => 16726293095,
    168 => 17218209369,
    169 => 17721631872,
    170 => 18236761289,
    171 => 18763800622,
    172 => 19302955209,
    173 => 19854432732,
    174 => 20418443236,
    175 => 20995199136,
    176 => 21584915236,
    177 => 22187808740,
    178 => 22804099263,
    179 => 23434008850,
    180 => 24077761983,
    181 => 24735585600,
    182 => 25407709103,
    183 => 26094364377,
    184 => 26795785797,
    185 => 27512210247,
    186 => 28243877131,
    187 => 28991028384,
    188 => 29753908491,
    189 => 30532764494,
    190 => 31327846011,
    191 => 32139405244,
    192 => 32967696998,
    193 => 33812978688,
    194 => 34675510358,
    195 => 35555554692,
    196 => 36453377025,
    197 => 37369245362,
    198 => 38303430385,
    199 => 39256205472,
    200 => 40227846705,
    201 => 41218632889,
    202 => 42228845559,
    203 => 43258768999,
    204 => 44308690253,
    205 => 45378899136,
    206 => 46469688253,
    207 => 47581353006,
    208 => 48714191613,
    209 => 49868505116,
    210 => 51044597400,
    211 => 52242775200,
    212 => 53463348120,
    213 => 54706628644,
    214 => 55972932147,
    215 => 57262576914,
    216 => 58575884147,
    217 => 59913177984,
    218 => 61274785507,
    219 => 62661036761,
    220 => 64072264761,
    221 => 65508805511,
    222 => 66970998015,
    223 => 68459184288,
    224 => 69973709375,
    225 => 71514921358,
    226 => 73083171375,
    227 => 74678813628,
    228 => 76302205402,
    229 => 77953707072,
    230 => 79633682122,
    231 => 81342497156,
    232 => 83080521909,
    233 => 84848129266,
    234 => 86645695269,
    235 => 88473599136,
    236 => 90332223269,
    237 => 92221953273,
    238 => 94143177963,
    239 => 96096289383,
    240 => 98081682817,
    241 => 100099756800,
    242 => 102150913137,
    243 => 104235556910,
    244 => 106354096497,
    245 => 108506943580,
    246 => 110694513164,
    247 => 112917223584,
    248 => 115175496524,
    249 => 117469757028,
    250 => 119800433511,
    251 => 122167957778,
    252 => 124572765031,
    253 => 127015293888,
    254 => 129495986391,
    255 => 132015288025,
    256 => 134573647725,
    257 => 137171517895,
    258 => 139809354419,
    259 => 142487616672,
    260 => 145206767539,
    261 => 147967273422,
    262 => 150769604259,
    263 => 153614233532,
    264 => 156501638286,
    265 => 159432299136,
    266 => 162406700286,
    267 => 165425329540,
    268 => 168488678313,
    269 => 171597241650,
    270 => 174751518233,
    271 => 177952010400,
    272 => 181199224153,
    273 => 184493669177,
    274 => 187835858847,
    275 => 191226310247
  }

  MAX_LEVEL = 275

  def self.xp_for_next_level(character)
    return "Infinity" if character['level'] == MAX_LEVEL

    next_level = character['level'] + 1
    xp = EXPERIENCE_BY_LEVEL.fetch(next_level)
    AppHelper.add_commas(xp - character['total_xp'])
  end

  def self.level_percent(character)
    return 0.0 if character['level'] == MAX_LEVEL

    current_level_xp = EXPERIENCE_BY_LEVEL.fetch(character['level'])
    next_level_xp = EXPERIENCE_BY_LEVEL.fetch(character['level'] + 1)

    (character['total_xp'] - current_level_xp) / (next_level_xp - current_level_xp).to_f
  end

  def self.percent_string(percent)
    (percent * 100).to_i.to_s + "%"
  end

  def self.progress_style(character)
    percent = percent_string(level_percent(character))
    "background-image: linear-gradient(to right,rgba(165, 42, 42,1) #{percent}, rgba(1,0,0,0) #{percent} 100%"
  end
end
